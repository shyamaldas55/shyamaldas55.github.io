<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Lottery Ticket Calculator</title>
  <style>
    table { border-collapse: collapse; width: 60%; margin: auto; }
    th, td { padding: 8px 12px; text-align: center; border: 1px solid #ccc; }
    input[type="number"] { width: 60px; text-align: center; }
    .center { text-align: center; margin-top: 20px; }
  </style>
</head>
<body>
  <h2 class="center">Lottery Ticket Profit Calculator</h2>
  <form id="lotteryForm">
    <table>
      <thead>
        <tr>
          <th>Number</th>
          <th>Tickets Sold</th>
          <th>Sales (â‚¹)</th>
        </tr>
      </thead>
      <tbody id="ticketTable">
        <!-- Rows will be inserted by JS -->
      </tbody>
    </table>
    <div class="center">
      <button type="submit">Calculate & Save</button>
    </div>
  </form>
  <div class="center">
    <p id="totalSold">Total Tickets Sold: 0</p>
    <p id="totalSales">Total Sales: â‚¹0</p>
  </div>

  <script>
    const tableBody = document.getElementById("ticketTable");
    const ticketPrice = 11;

    for (let i = 0; i <= 9; i++) {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${i}</td>
        <td><input type="number" min="0" value="0" data-number="${i}"></td>
        <td class="sale">â‚¹0</td>
      `;
      tableBody.appendChild(row);
    }

    document.getElementById("lotteryForm").addEventListener("submit", async function(e) {
      e.preventDefault();

      const inputs = document.querySelectorAll("input[type='number']");
      const salesCells = document.querySelectorAll(".sale");

      let totalSold = 0;
      let totalSales = 0;
      let data = [];

      inputs.forEach((input, index) => {
        const number = input.getAttribute("data-number");
        const qty = parseInt(input.value.replace(/^0+/, '')) || 0;
        const sales = qty * ticketPrice;
        totalSold += qty;
        totalSales += sales;
        salesCells[index].textContent = `â‚¹${sales}`;

        if (qty > 0) {
          data.push({
            number: number,
            ticketsSold: qty,
            totalSales: sales
          });
        }
      });

      document.getElementById("totalSold").textContent = `Total Tickets Sold: ${totalSold}`;
      document.getElementById("totalSales").textContent = `Total Sales: â‚¹${totalSales}`;

      // ðŸ‘‰ REPLACE this with your actual Web App URL
      const url = "https://script.google.com/macros/s/YOUR_DEPLOYMENT_ID/exec";

      try {
        await fetch(url, {
          method: "POST",
          mode: "no-cors", // Required to avoid CORS error
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(data),
        });
        alert("Data saved to Google Sheet!");
      } catch (error) {
        alert("Failed to save to Google Sheet");
        console.error(error);
      }
    });
  </script>
</body>
</html>
